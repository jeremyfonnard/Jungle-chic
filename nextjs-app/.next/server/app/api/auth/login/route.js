"use strict";(()=>{var e={};e.id=873,e.ids=[873],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},78893:e=>{e.exports=require("buffer")},84770:e=>{e.exports=require("crypto")},76162:e=>{e.exports=require("stream")},21764:e=>{e.exports=require("util")},31608:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>x,patchFetch:()=>v,requestAsyncStorage:()=>m,routeModule:()=>f,serverHooks:()=>h,staticGenerationAsyncStorage:()=>g});var n={};r.r(n),r.d(n,{POST:()=>c});var a=r(49303),i=r(88716),o=r(60670),s=r(87070),u=r(26039),l=r(42023),p=r.n(l),d=r(90455);async function c(e){try{let{email:t,password:r}=await e.json(),n=await (0,u.z)(),a=await n.collection("users").findOne({email:t});if(!a||!a.password||!await p().compare(r,a.password))return s.NextResponse.json({detail:"Invalid credentials"},{status:401});let i=(0,d.V3)(a.id,a.email);return s.NextResponse.json({user:{id:a.id,email:a.email,first_name:a.first_name,last_name:a.last_name,created_at:a.created_at},token:i})}catch(e){return console.error("Login error:",e),s.NextResponse.json({detail:"Login failed"},{status:500})}}let f=new a.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/auth/login/route",pathname:"/api/auth/login",filename:"route",bundlePath:"app/api/auth/login/route"},resolvedPagePath:"/app/nextjs-app/app/api/auth/login/route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:m,staticGenerationAsyncStorage:g,serverHooks:h}=f,x="/api/auth/login/route";function v(){return(0,o.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:g})}},90455:(e,t,r)=>{r.d(t,{V3:()=>s,ts:()=>u});var n=r(41482),a=r.n(n),i=r(26039);let o=process.env.JWT_SECRET||"jungle-swimwear-secret-key-2024";function s(e,t){return a().sign({user_id:e,email:t},o,{expiresIn:"30d"})}async function u(e){let t=e.headers.get("authorization");if(!t||!t.startsWith("Bearer "))return null;let r=function(e){try{return a().verify(e,o)}catch{return null}}(t.split(" ")[1]);if(!r)return null;let n=await (0,i.z)();return await n.collection("users").findOne({id:r.user_id},{projection:{_id:0,password:0}})}},26039:(e,t,r)=>{let n;r.d(t,{z:()=>o});let a=require("mongodb");if(!process.env.MONGODB_URI)throw Error("Please add your Mongo URI to .env.local");let i=process.env.MONGODB_URI;async function o(){return(await n).db(process.env.DB_NAME)}n=new a.MongoClient(i,{}).connect()}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[276,972,482,23],()=>r(31608));module.exports=n})();